# CloudPayments Meeting Badge

Бейдж для отображения информации о встречах в OBS Studio с интеграцией Google Calendar.

## ✨ Последние обновления

### v2.0 - Оптимизация и улучшения
- ✅ **Поддержка повторяющихся событий** - корректное отображение ежедневных и еженедельных встреч
- ✅ **Оптимизация кода** - сокращение на 14% (с 884 до 762 строк)
- ✅ **Улучшенная система логирования** - упрощенный и эффективный Logger
- ✅ **Исправлена генерация событий** - правильное время для повторяющихся встреч
- ✅ **Упрощенная архитектура** - удалены дублирующиеся функции и избыточный код

## 🚀 Быстрый старт

1. **Скачайте файлы** проекта
2. **Откройте `index.html`** в браузере
3. **Настройте календарь** (см. раздел "Настройка календаря")
4. **Добавьте в OBS** как Browser Source

## 📅 Настройка календаря

### Шаг 1: Получите ссылку на календарь
1. Откройте [Google Calendar](https://calendar.google.com)
2. Найдите ваш календарь в левом меню
3. Нажмите на три точки → "Настройки и доступ"
4. Прокрутите вниз до "Интеграция календаря"
5. Скопируйте "Секретный адрес в формате iCal"

### Шаг 2: Обновите конфигурацию
1. Откройте файл `config.js`
2. Найдите строку `CALENDAR_URL:`
3. Вставьте скопированную ссылку вместо текущей
4. Сохраните файл

```javascript
const CONFIG = {
    CALENDAR_URL: 'ВАША_ССЫЛКА_НА_КАЛЕНДАРЬ_ЗДЕСЬ',
    // ... остальные настройки
};
```

## ⚙️ Настройка OBS

### Добавление Browser Source
1. В OBS добавьте новый источник "Browser Source"
2. **URL:** `https://ваш-сайт.com/meeting-badge/`
3. **Ширина:** `686px`
4. **Высота:** `350px`
5. **Обновить браузер при активации сцены:** ✅
6. **Остановить источник когда не виден:** ❌

## 🔧 Функции

### Автоматическое обновление
- **Таймер:** каждую секунду
- **Календарь:** каждые 30 секунд
- **OBS:** каждые 30 секунд
- **При фокусе:** мгновенно

### Ручное обновление
- **F5** - обновить календарь
- **Ctrl+R** - обновить календарь
- **Консоль:** `refreshCalendar()` или `forceOBSRefresh()`

### Отображение
- **Есть встреча:** показывает оставшееся время + заполнение
- **Нет встречи:** показывает "Free-time" + время до следующей
- **Нет встреч:** показывает логотип компании
- **Повторяющиеся события:** автоматически генерируются для текущего дня (ежедневные, еженедельные)

## 📁 Структура проекта

```
cloudpayments-meeting-badge/
├── index.html          # Основная страница
├── style.css           # Стили
├── script.js           # Логика приложения
├── config.js           # Конфигурация
├── assets/             # Ресурсы
│   ├── svg/           # Иконки и логотипы
│   └── fonts/         # Шрифты
└── README.md          # Документация
```

## 🌿 Ветки (Git branches)

- `main` — основная и единственная прод-ветка. С неё деплоится GitHub Pages.
- `test` — ветка для проверок/экспериментов. По готовности изменения вливаются в `main`.

Быстро:

```bash
# создать ветку для проверки
git checkout -b test

# отправить изменения
git add -A && git commit -m "feat: ..." && git push -u origin test

# после проверки — PR в main и merge
```

## 🌐 Деплой на GitHub Pages (из main)

1) В настройках репозитория включите Pages: Settings → Pages → Branch: `main`, Folder: `/`.
2) Страница будет доступна по адресу:

```
https://<ваш-логин>.github.io/<название-репозитория>/
```

Любые коммиты в `main` автоматически публикуются.

## 📏 Размеры бейджа

### Основные размеры:
- **Общий размер:** `686×350px`
- **Бейдж с таймером:** `626×130px`
- **Бейдж должности + ФИО:** `626×80px`
- **Зоны ответственности:** `626×40px`

### Структура:
```
┌─────────────────────────────────────┐ 686px
│  Бейдж с таймером (626×130px)      │
├─────────────────────────────────────┤
│  PM    │  Апалишин Марк            │ 80px
├─────────────────────────────────────┤
│  Alt-методы, реклама               │ 40px
└─────────────────────────────────────┘
```

## 🐛 Отладка

### Локальная отладка
1. Откройте `index.html` в браузере
2. Нажмите F12 → Console
3. Проверьте логи загрузки календаря

### Проблемы с календарем
- Убедитесь, что календарь публичный
- Проверьте правильность ссылки в `config.js`
- Проверьте CORS настройки

### Проблемы с OBS
- Убедитесь, что URL правильный
- Проверьте настройки Browser Source
- Попробуйте `forceOBSRefresh()` в консоли

## 📝 Лицензия

Проект создан для CloudPayments. Все права защищены.

## 🤝 Поддержка

При возникновении проблем:
1. Проверьте консоль браузера на ошибки
2. Убедитесь в правильности настройки календаря
3. Проверьте настройки OBS Browser Source
